<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
        }

        .login-container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            margin: 50px auto;
        }

        .login-container h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #2a5298;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        button {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        button:hover {
            background: linear-gradient(135deg, #2a5298, #1e3c72);
            transform: translateY(-2px);
        }

        .dashboard {
            display: none;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .user-info {
            font-weight: 600;
            color: #2a5298;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .tab.active {
            border-bottom: 3px solid #2a5298;
            font-weight: 600;
            color: #2a5298;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .status-pending {
            color: #ff9800;
            font-weight: 600;
        }

        .status-approved {
            color: #4caf50;
            font-weight: 600;
        }

        .status-rejected {
            color: #f44336;
            font-weight: 600;
        }

        .status-inactive {
            color: #9e9e9e;
            font-weight: 600;
        }

        .action-btn {
            padding: 5px 10px;
            margin-right: 5px;
            width: auto;
            font-size: 14px;
        }

        .action-btn.approve {
            background: linear-gradient(135deg, #4caf50, #45a049);
        }

        .action-btn.reject {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .action-btn.delete {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .action-btn.inactive {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .action-btn.active {
            background: linear-gradient(135deg, #4caf50, #45a049);
        }

        .form-container {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .card {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            margin-bottom: 10px;
            color: #2a5298;
        }

        .guidelines {
            line-height: 1.6;
        }

        .guidelines ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .logout-btn {
            width: auto;
            padding: 8px 15px;
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .logout-btn:hover {
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
        }

        .attendance-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .attendance-form input, .attendance-form select {
            flex: 1;
            min-width: 150px;
        }

        .time-display {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
            color: #2a5298;
        }

        .message {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }

        .message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .attendance-form {
                flex-direction: column;
            }
            
            .tabs {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>School Management System</h1>
            <p style="text-align: center;">Admin, Teacher & Student Portal</p>
        </header>

        <!-- Login Section -->
        <div id="login-section" class="login-container">
            <h2>Login to Your Account</h2>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            <div class="form-group">
                <label for="role">Role</label>
                <select id="role">
                    <option value="admin">Administrator</option>
                    <option value="teacher">Teacher</option>
                    <option value="student">Student</option>
                </select>
            </div>
            <button id="login-btn">Login</button>
            
            <div id="login-message" class="message"></div>
            
            <div style="margin-top: 20px; text-align: center;">
                <p><strong>Demo Credentials:</strong></p>
                <p>Admin: admin / admin123</p>
                <p>Teacher: teacher1 / pass123</p>
                <p>Student: student1 / stud123</p>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="admin-dashboard" class="dashboard">
            <div class="dashboard-header">
                <h2>Administrator Dashboard</h2>
                <div>
                    <span class="user-info">Welcome, Admin</span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="switchTab('admin', 'attendance')">Teacher Attendance</div>
                <div class="tab" onclick="switchTab('admin', 'lesson-notes')">Lesson Notes</div>
                <div class="tab" onclick="switchTab('admin', 'assignments')">Assignments</div>
                <div class="tab" onclick="switchTab('admin', 'students')">Student Management</div>
                <div class="tab" onclick="switchTab('admin', 'teachers')">Teacher Management</div>
            </div>

            <!-- Teacher Attendance Tab -->
            <div id="admin-attendance" class="tab-content active">
                <h3>Teacher Attendance Records</h3>
                
                <div class="form-container">
                    <h4>Record Teacher Attendance</h4>
                    <div class="time-display" id="current-time">Current Time: <span id="time-display"></span></div>
                    <div class="attendance-form">
                        <select id="teacher-select">
                            <option value="">Select Teacher</option>
                        </select>
                        <select id="attendance-type">
                            <option value="arrival">Record Arrival</option>
                            <option value="departure">Record Departure</option>
                        </select>
                        <button onclick="recordAttendance()">Record Attendance</button>
                    </div>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Teacher</th>
                            <th>Arrival Time</th>
                            <th>Departure Time</th>
                            <th>Hours Worked</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="attendance-table">
                        <!-- Attendance data will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Lesson Notes Tab -->
            <div id="admin-lesson-notes" class="tab-content">
                <h3>Lesson Notes Management</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Teacher</th>
                            <th>Date</th>
                            <th>Subject</th>
                            <th>Lesson Note</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="lesson-notes-table">
                        <!-- Lesson notes data will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Assignments Tab -->
            <div id="admin-assignments" class="tab-content">
                <h3>Assignments Management</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Teacher</th>
                            <th>Class</th>
                            <th>Subject</th>
                            <th>Assignment</th>
                            <th>Due Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="assignments-table">
                        <!-- Assignments data will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Student Management Tab -->
            <div id="admin-students" class="tab-content">
                <h3>Student Management</h3>
                
                <div class="form-container">
                    <h4>Add New Student</h4>
                    <div class="grid-2">
                        <input type="text" id="student-name" placeholder="Student Name">
                        <select id="student-class">
                            <option value="">Select Class</option>
                            <option value="Grade 1">Grade 1</option>
                            <option value="Grade 2">Grade 2</option>
                            <option value="Grade 3">Grade 3</option>
                        </select>
                    </div>
                    <button onclick="addStudent()" style="margin-top: 15px;">Add Student</button>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>Student ID</th>
                            <th>Name</th>
                            <th>Class</th>
                            <th>Username</th>
                            <th>Password</th>
                            <th>Added By</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="students-table">
                        <!-- Students data will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Teacher Management Tab -->
            <div id="admin-teachers" class="tab-content">
                <h3>Teacher Management</h3>
                
                <div class="form-container">
                    <h4>Register New Teacher</h4>
                    <div class="grid-2">
                        <input type="text" id="teacher-name" placeholder="Teacher Full Name">
                        <input type="email" id="teacher-email" placeholder="Teacher Email">
                        <select id="teacher-class">
                            <option value="">Assign to Class</option>
                            <option value="Grade 1">Grade 1</option>
                            <option value="Grade 2">Grade 2</option>
                            <option value="Grade 3">Grade 3</option>
                        </select>
                        <input type="text" id="teacher-subject" placeholder="Primary Subject">
                    </div>
                    <button onclick="registerTeacher()" style="margin-top: 15px;">Register Teacher</button>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>Teacher ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Class</th>
                            <th>Subject</th>
                            <th>Username</th>
                            <th>Password</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="teachers-table">
                        <!-- Teachers data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Teacher Dashboard -->
        <div id="teacher-dashboard" class="dashboard">
            <div class="dashboard-header">
                <h2>Teacher Dashboard</h2>
                <div>
                    <span class="user-info" id="teacher-welcome">Welcome, Teacher</span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="switchTab('teacher', 'attendance')">My Attendance</div>
                <div class="tab" onclick="switchTab('teacher', 'guidelines')">Guidelines</div>
                <div class="tab" onclick="switchTab('teacher', 'submit-lesson')">Submit Lesson Note</div>
                <div class="tab" onclick="switchTab('teacher', 'my-lessons')">My Lesson Notes</div>
                <div class="tab" onclick="switchTab('teacher', 'submit-assignment')">Submit Assignment</div>
                <div class="tab" onclick="switchTab('teacher', 'my-assignments')">My Assignments</div>
            </div>

            <!-- Teacher Attendance Tab -->
            <div id="teacher-attendance" class="tab-content active">
                <h3>My Attendance Records</h3>
                <div class="time-display">Current Time: <span id="teacher-time-display"></span></div>
                
                <div class="form-container">
                    <h4>Record My Attendance</h4>
                    <div class="attendance-form">
                        <select id="teacher-attendance-type">
                            <option value="arrival">Record My Arrival</option>
                            <option value="departure">Record My Departure</option>
                        </select>
                        <button onclick="recordMyAttendance()">Record Attendance</button>
                    </div>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Arrival Time</th>
                            <th>Departure Time</th>
                            <th>Hours Worked</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="teacher-attendance-table">
                        <!-- Teacher's attendance records will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Guidelines Tab -->
            <div id="teacher-guidelines" class="tab-content">
                <h3>Teacher Guidelines</h3>
                <div class="guidelines">
                    <div class="card">
                        <h3>Lesson Note Writing Guidelines</h3>
                        <ul>
                            <li>Include clear learning objectives for each lesson</li>
                            <li>Detail the teaching methodology to be used</li>
                            <li>List required materials and resources</li>
                            <li>Outline the lesson structure and timing</li>
                            <li>Include assessment methods and evaluation criteria</li>
                            <li>Specify homework or follow-up activities</li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h3>Assignment Creation Guidelines</h3>
                        <ul>
                            <li>Clearly state the assignment objectives</li>
                            <li>Provide detailed instructions for completion</li>
                            <li>Specify the submission deadline</li>
                            <li>Include grading criteria and rubrics</li>
                            <li>Ensure assignments align with curriculum standards</li>
                            <li>Consider diverse learning needs when designing tasks</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Submit Lesson Note Tab -->
            <div id="teacher-submit-lesson" class="tab-content">
                <h3>Submit New Lesson Note</h3>
                <div class="form-container">
                    <div class="form-group">
                        <label for="lesson-subject">Subject</label>
                        <input type="text" id="lesson-subject" placeholder="Enter subject">
                    </div>
                    <div class="form-group">
                        <label for="lesson-note">Lesson Note</label>
                        <textarea id="lesson-note" rows="6" placeholder="Enter your lesson note details" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                    </div>
                    <button onclick="submitLessonNote()">Submit Lesson Note</button>
                </div>
            </div>

            <!-- My Lesson Notes Tab -->
            <div id="teacher-my-lessons" class="tab-content">
                <h3>My Submitted Lesson Notes</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Subject</th>
                            <th>Lesson Note</th>
                            <th>Status</th>
                            <th>Feedback</th>
                        </tr>
                    </thead>
                    <tbody id="teacher-lessons-table">
                        <!-- Teacher's lesson notes will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Submit Assignment Tab -->
            <div id="teacher-submit-assignment" class="tab-content">
                <h3>Create New Assignment</h3>
                <div class="form-container">
                    <div class="grid-2">
                        <div class="form-group">
                            <label for="assignment-class">Class</label>
                            <select id="assignment-class">
                                <option value="">Select Class</option>
                                <option value="Grade 1">Grade 1</option>
                                <option value="Grade 2">Grade 2</option>
                                <option value="Grade 3">Grade 3</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="assignment-subject">Subject</label>
                            <input type="text" id="assignment-subject" placeholder="Enter subject">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="assignment-details">Assignment Details</label>
                        <textarea id="assignment-details" rows="4" placeholder="Enter assignment details" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="due-date">Due Date</label>
                        <input type="date" id="due-date">
                    </div>
                    <button onclick="submitAssignment()">Submit Assignment</button>
                </div>
            </div>

            <!-- My Assignments Tab -->
            <div id="teacher-my-assignments" class="tab-content">
                <h3>My Submitted Assignments</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Class</th>
                            <th>Subject</th>
                            <th>Assignment</th>
                            <th>Due Date</th>
                            <th>Status</th>
                            <th>Feedback</th>
                        </tr>
                    </thead>
                    <tbody id="teacher-assignments-table">
                        <!-- Teacher's assignments will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Student Dashboard -->
        <div id="student-dashboard" class="dashboard">
            <div class="dashboard-header">
                <h2>Student Dashboard</h2>
                <div>
                    <span class="user-info">Welcome, Student</span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="switchTab('student', 'my-assignments')">My Assignments</div>
            </div>

            <!-- My Assignments Tab -->
            <div id="student-my-assignments" class="tab-content active">
                <h3>My Assignments</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Teacher</th>
                            <th>Subject</th>
                            <th>Assignment</th>
                            <th>Due Date</th>
                            <th>Status</th>
                            <th>Feedback</th>
                        </tr>
                    </thead>
                    <tbody id="student-assignments-table">
                        <!-- Student's assignments will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Sample data for the system
        const sampleData = {
            users: [
                { username: 'admin', password: 'admin123', role: 'admin', name: 'Administrator', status: 'active' },
                { username: 'teacher1', password: 'pass123', role: 'teacher', name: 'John Smith', class: 'Grade 1', email: 'john.smith@school.edu', subject: 'Mathematics', status: 'active' },
                { username: 'teacher2', password: 'pass123', role: 'teacher', name: 'Sarah Johnson', class: 'Grade 2', email: 'sarah.johnson@school.edu', subject: 'Science', status: 'active' },
                { username: 'student1', password: 'stud123', role: 'student', name: 'Michael Brown', class: 'Grade 1', status: 'active' },
                { username: 'student2', password: 'stud123', role: 'student', name: 'Emily Davis', class: 'Grade 2', status: 'active' }
            ],
            attendance: [
                { date: '2023-10-01', teacher: 'John Smith', arrival: '08:00', departure: '15:30', hours: 7.5, status: 'complete' },
                { date: '2023-10-01', teacher: 'Sarah Johnson', arrival: '08:15', departure: '15:45', hours: 7.5, status: 'complete' },
                { date: '2023-10-02', teacher: 'John Smith', arrival: '07:55', departure: '15:25', hours: 7.5, status: 'complete' },
                { date: new Date().toISOString().split('T')[0], teacher: 'John Smith', arrival: '08:05', departure: '', hours: 0, status: 'present' }
            ],
            lessonNotes: [
                { id: 1, teacher: 'John Smith', date: '2023-10-01', subject: 'Mathematics', note: 'Introduction to basic arithmetic operations', status: 'approved', feedback: 'Well structured lesson plan' },
                { id: 2, teacher: 'Sarah Johnson', date: '2023-10-02', subject: 'Science', note: 'Exploring the solar system and planets', status: 'pending', feedback: '' },
                { id: 3, teacher: 'John Smith', date: '2023-10-03', subject: 'English', note: 'Grammar: Parts of speech and sentence structure', status: 'rejected', feedback: 'Please include more interactive activities' }
            ],
            assignments: [
                { id: 1, teacher: 'John Smith', class: 'Grade 1', subject: 'Mathematics', assignment: 'Complete exercises 1-5 on page 23', dueDate: '2023-10-10', status: 'approved', feedback: 'Good assignment covering key concepts' },
                { id: 2, teacher: 'Sarah Johnson', class: 'Grade 2', subject: 'Science', assignment: 'Research and write about your favorite planet', dueDate: '2023-10-15', status: 'pending', feedback: '' },
                { id: 3, teacher: 'John Smith', class: 'Grade 1', subject: 'English', assignment: 'Write a short story using at least 5 adjectives', dueDate: '2023-10-12', status: 'approved', feedback: 'Creative writing assignment well designed' }
            ],
            students: [
                { id: 'STU001', name: 'Michael Brown', class: 'Grade 1', username: 'student1', password: 'stud123', addedBy: 'admin', status: 'active' },
                { id: 'STU002', name: 'Emily Davis', class: 'Grade 2', username: 'student2', password: 'stud123', addedBy: 'admin', status: 'active' },
                { id: 'STU003', name: 'James Wilson', class: 'Grade 1', username: 'student3', password: 'stud123', addedBy: 'John Smith', status: 'active' }
            ]
        };

        // Current user information
        let currentUser = null;
        let timeInterval;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check if there's a logged-in user in sessionStorage
            const savedUser = sessionStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
            
            // Start the clock
            updateClock();
            timeInterval = setInterval(updateClock, 1000);
            
            // Populate teacher select dropdown
            populateTeacherSelect();
            
            // Set up login button event listener
            document.getElementById('login-btn').addEventListener('click', login);
            
            // Allow Enter key to trigger login
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
        });

        // Update the clock display
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById('time-display').textContent = timeString;
            document.getElementById('teacher-time-display').textContent = timeString;
        }

        // Login function
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;
            
            const messageEl = document.getElementById('login-message');
            
            // Validate inputs
            if (!username || !password) {
                showMessage(messageEl, 'Please enter both username and password', 'error');
                return;
            }
            
            // Find user in sample data
            const user = sampleData.users.find(u => 
                u.username === username && u.password === password && u.role === role && u.status === 'active'
            );
            
            if (user) {
                currentUser = user;
                // Save user to sessionStorage
                sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
                showDashboard();
            } else {
                showMessage(messageEl, 'Invalid username, password, or role selection', 'error');
            }
        }

        // Show appropriate dashboard based on user role
        function showDashboard() {
            // Hide login section
            document.getElementById('login-section').style.display = 'none';
            
            // Hide all dashboards first
            document.getElementById('admin-dashboard').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('student-dashboard').style.display = 'none';
            
            // Show appropriate dashboard
            if (currentUser.role === 'admin') {
                document.getElementById('admin-dashboard').style.display = 'block';
                updateAdminDashboard();
            } else if (currentUser.role === 'teacher') {
                document.getElementById('teacher-dashboard').style.display = 'block';
                document.getElementById('teacher-welcome').textContent = `Welcome, ${currentUser.name}`;
                updateTeacherDashboard();
            } else if (currentUser.role === 'student') {
                document.getElementById('student-dashboard').style.display = 'block';
                updateStudentDashboard();
            }
        }

        // Logout function
        function logout() {
            currentUser = null;
            sessionStorage.removeItem('currentUser');
            
            // Hide all dashboards
            document.getElementById('admin-dashboard').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('student-dashboard').style.display = 'none';
            
            // Show login section
            document.getElementById('login-section').style.display = 'block';
            
            // Clear login form
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('role').value = 'admin';
        }

        // Switch between tabs
        function switchTab(userType, tabName) {
            // Hide all tab contents for this user type
            const tabContents = document.querySelectorAll(`#${userType}-dashboard .tab-content`);
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll(`#${userType}-dashboard .tab`);
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Activate selected tab
            document.getElementById(`${userType}-${tabName}`).classList.add('active');
            
            // Find and activate the clicked tab
            for (let tab of tabs) {
                if (tab.textContent.trim().toLowerCase().replace(/\s+/g, '-') === tabName) {
                    tab.classList.add('active');
                    break;
                }
            }
        }

        // Update admin dashboard with current data
        function updateAdminDashboard() {
            // Update attendance table
            const attendanceTable = document.getElementById('attendance-table');
            attendanceTable.innerHTML = '';
            
            // Sort attendance by date (newest first)
            const sortedAttendance = [...sampleData.attendance].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedAttendance.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.teacher}</td>
                    <td>${record.arrival || '-'}</td>
                    <td>${record.departure || '-'}</td>
                    <td>${record.hours > 0 ? record.hours + ' hours' : '-'}</td>
                    <td><span class="status-${record.status === 'complete' ? 'approved' : 'pending'}">${record.status}</span></td>
                `;
                attendanceTable.appendChild(row);
            });
            
            // Update lesson notes table
            const lessonNotesTable = document.getElementById('lesson-notes-table');
            lessonNotesTable.innerHTML = '';
            
            sampleData.lessonNotes.forEach(note => {
                const statusClass = `status-${note.status}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${note.teacher}</td>
                    <td>${note.date}</td>
                    <td>${note.subject}</td>
                    <td>${note.note}</td>
                    <td><span class="${statusClass}">${note.status}</span></td>
                    <td>
                        ${note.status === 'pending' ? 
                            `<button class="action-btn approve" onclick="approveLessonNote(${note.id})">Approve</button>
                             <button class="action-btn reject" onclick="rejectLessonNote(${note.id})">Reject</button>` : 
                            'Action taken'
                        }
                    </td>
                `;
                lessonNotesTable.appendChild(row);
            });
            
            // Update assignments table
            const assignmentsTable = document.getElementById('assignments-table');
            assignmentsTable.innerHTML = '';
            
            sampleData.assignments.forEach(assignment => {
                const statusClass = `status-${assignment.status}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${assignment.teacher}</td>
                    <td>${assignment.class}</td>
                    <td>${assignment.subject}</td>
                    <td>${assignment.assignment}</td>
                    <td>${assignment.dueDate}</td>
                    <td><span class="${statusClass}">${assignment.status}</span></td>
                    <td>
                        ${assignment.status === 'pending' ? 
                            `<button class="action-btn approve" onclick="approveAssignment(${assignment.id})">Approve</button>
                             <button class="action-btn reject" onclick="rejectAssignment(${assignment.id})">Reject</button>` : 
                            'Action taken'
                        }
                    </td>
                `;
                assignmentsTable.appendChild(row);
            });
            
            // Update students table
            const studentsTable = document.getElementById('students-table');
            studentsTable.innerHTML = '';
            
            sampleData.students.forEach(student => {
                const statusClass = `status-${student.status}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>${student.username}</td>
                    <td>${student.password}</td>
                    <td>${student.addedBy}</td>
                    <td><span class="${statusClass}">${student.status}</span></td>
                `;
                studentsTable.appendChild(row);
            });
            
            // Update teachers table
            const teachersTable = document.getElementById('teachers-table');
            teachersTable.innerHTML = '';
            
            const teachers = sampleData.users.filter(user => user.role === 'teacher');
            teachers.forEach(teacher => {
                const statusClass = `status-${teacher.status}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>TCH${teachers.indexOf(teacher) + 1}</td>
                    <td>${teacher.name}</td>
                    <td>${teacher.email || '-'}</td>
                    <td>${teacher.class || '-'}</td>
                    <td>${teacher.subject || '-'}</td>
                    <td>${teacher.username}</td>
                    <td>${teacher.password}</td>
                    <td><span class="${statusClass}">${teacher.status}</span></td>
                    <td>
                        ${teacher.status === 'active' ? 
                            `<button class="action-btn inactive" onclick="toggleTeacherStatus('${teacher.username}', 'inactive')">Deactivate</button>` : 
                            `<button class="action-btn active" onclick="toggleTeacherStatus('${teacher.username}', 'active')">Activate</button>`
                        }
                        <button class="action-btn delete" onclick="deleteTeacher('${teacher.username}')">Delete</button>
                    </td>
                `;
                teachersTable.appendChild(row);
            });
        }

        // Update teacher dashboard with current data
        function updateTeacherDashboard() {
            // Update teacher's attendance
            const teacherAttendanceTable = document.getElementById('teacher-attendance-table');
            teacherAttendanceTable.innerHTML = '';
            
            const teacherAttendance = sampleData.attendance.filter(record => record.teacher === currentUser.name)
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            teacherAttendance.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.arrival || '-'}</td>
                    <td>${record.departure || '-'}</td>
                    <td>${record.hours > 0 ? record.hours + ' hours' : '-'}</td>
                    <td><span class="status-${record.status === 'complete' ? 'approved' : 'pending'}">${record.status}</span></td>
                `;
                teacherAttendanceTable.appendChild(row);
            });
            
            // Update teacher's lesson notes
            const teacherLessonsTable = document.getElementById('teacher-lessons-table');
            teacherLessonsTable.innerHTML = '';
            
            const teacherNotes = sampleData.lessonNotes.filter(note => note.teacher === currentUser.name);
            teacherNotes.forEach(note => {
                const statusClass = `status-${note.status}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${note.date}</td>
                    <td>${note.subject}</td>
                    <td>${note.note}</td>
                    <td><span class="${statusClass}">${note.status}</span></td>
                    <td>${note.feedback || '-'}</td>
                `;
                teacherLessonsTable.appendChild(row);
            });
            
            // Update teacher's assignments
            const teacherAssignmentsTable = document.getElementById('teacher-assignments-table');
            teacherAssignmentsTable.innerHTML = '';
            
            const teacherAssignments = sampleData.assignments.filter(assignment => assignment.teacher === currentUser.name);
            teacherAssignments.forEach(assignment => {
                const statusClass = `status-${assignment.status}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${assignment.dueDate}</td>
                    <td>${assignment.class}</td>
                    <td>${assignment.subject}</td>
                    <td>${assignment.assignment}</td>
                    <td>${assignment.dueDate}</td>
                    <td><span class="${statusClass}">${assignment.status}</span></td>
                    <td>${assignment.feedback || '-'}</td>
                `;
                teacherAssignmentsTable.appendChild(row);
            });
        }

        // Update student dashboard with current data
        function updateStudentDashboard() {
            // Update student's assignments
            const studentAssignmentsTable = document.getElementById('student-assignments-table');
            studentAssignmentsTable.innerHTML = '';
            
            const studentClass = currentUser.class;
            const studentAssignments = sampleData.assignments.filter(assignment => 
                assignment.class === studentClass && assignment.status === 'approved'
            );
            
            if (studentAssignments.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">No assignments available</td>`;
                studentAssignmentsTable.appendChild(row);
            } else {
                studentAssignments.forEach(assignment => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${assignment.teacher}</td>
                        <td>${assignment.subject}</td>
                        <td>${assignment.assignment}</td>
                        <td>${assignment.dueDate}</td>
                        <td><span class="status-approved">Active</span></td>
                        <td>${assignment.feedback || '-'}</td>
                    `;
                    studentAssignmentsTable.appendChild(row);
                });
            }
        }

        // Populate teacher select dropdown
        function populateTeacherSelect() {
            const teacherSelect = document.getElementById('teacher-select');
            teacherSelect.innerHTML = '<option value="">Select Teacher</option>';
            
            const teachers = sampleData.users.filter(user => user.role === 'teacher' && user.status === 'active');
            teachers.forEach(teacher => {
                const option = document.createElement('option');
                option.value = teacher.name;
                option.textContent = teacher.name;
                teacherSelect.appendChild(option);
            });
        }

        // Record teacher attendance (admin function)
        function recordAttendance() {
            const teacher = document.getElementById('teacher-select').value;
            const attendanceType = document.getElementById('attendance-type').value;
            
            if (!teacher) {
                alert('Please select a teacher');
                return;
            }
            
            const now = new Date();
            const currentTime = now.toTimeString().split(' ')[0].substring(0, 5); // HH:MM format
            const today = now.toISOString().split('T')[0];
            
            // Check if there's already an attendance record for today
            let attendanceRecord = sampleData.attendance.find(record => 
                record.teacher === teacher && record.date === today
            );
            
            if (attendanceRecord) {
                // Update existing record
                if (attendanceType === 'arrival') {
                    attendanceRecord.arrival = currentTime;
                    attendanceRecord.status = attendanceRecord.departure ? 'complete' : 'present';
                } else {
                    attendanceRecord.departure = currentTime;
                    // Calculate hours worked
                    if (attendanceRecord.arrival) {
                        const arrivalTime = new Date(`2000-01-01T${attendanceRecord.arrival}`);
                        const departureTime = new Date(`2000-01-01T${currentTime}`);
                        const hours = (departureTime - arrivalTime) / (1000 * 60 * 60);
                        attendanceRecord.hours = Math.round(hours * 10) / 10;
                    }
                    attendanceRecord.status = 'complete';
                }
            } else {
                // Create new record
                attendanceRecord = {
                    date: today,
                    teacher: teacher,
                    arrival: attendanceType === 'arrival' ? currentTime : '',
                    departure: attendanceType === 'departure' ? currentTime : '',
                    hours: 0,
                    status: attendanceType === 'arrival' ? 'present' : 'incomplete'
                };
                sampleData.attendance.push(attendanceRecord);
            }
            
            // Update dashboard
            updateAdminDashboard();
            
            alert(`Attendance recorded successfully for ${teacher} at ${currentTime}`);
        }

        // Record teacher's own attendance (teacher function)
        function recordMyAttendance() {
            const attendanceType = document.getElementById('teacher-attendance-type').value;
            const teacher = currentUser.name;
            
            const now = new Date();
            const currentTime = now.toTimeString().split(' ')[0].substring(0, 5); // HH:MM format
            const today = now.toISOString().split('T')[0];
            
            // Check if there's already an attendance record for today
            let attendanceRecord = sampleData.attendance.find(record => 
                record.teacher === teacher && record.date === today
            );
            
            if (attendanceRecord) {
                // Update existing record
                if (attendanceType === 'arrival') {
                    if (attendanceRecord.arrival) {
                        alert('You have already recorded your arrival for today');
                        return;
                    }
                    attendanceRecord.arrival = currentTime;
                    attendanceRecord.status = attendanceRecord.departure ? 'complete' : 'present';
                } else {
                    if (attendanceRecord.departure) {
                        alert('You have already recorded your departure for today');
                        return;
                    }
                    attendanceRecord.departure = currentTime;
                    // Calculate hours worked
                    if (attendanceRecord.arrival) {
                        const arrivalTime = new Date(`2000-01-01T${attendanceRecord.arrival}`);
                        const departureTime = new Date(`2000-01-01T${currentTime}`);
                        const hours = (departureTime - arrivalTime) / (1000 * 60 * 60);
                        attendanceRecord.hours = Math.round(hours * 10) / 10;
                    }
                    attendanceRecord.status = 'complete';
                }
            } else {
                // Create new record
                attendanceRecord = {
                    date: today,
                    teacher: teacher,
                    arrival: attendanceType === 'arrival' ? currentTime : '',
                    departure: attendanceType === 'departure' ? currentTime : '',
                    hours: 0,
                    status: attendanceType === 'arrival' ? 'present' : 'incomplete'
                };
                sampleData.attendance.push(attendanceRecord);
            }
            
            // Update dashboard
            updateTeacherDashboard();
            
            alert(`Your ${attendanceType} has been recorded at ${currentTime}`);
        }

        // Approve lesson note
        function approveLessonNote(id) {
            const note = sampleData.lessonNotes.find(n => n.id === id);
            if (note) {
                note.status = 'approved';
                note.feedback = 'Approved by admin on ' + new Date().toLocaleDateString();
                updateAdminDashboard();
            }
        }

        // Reject lesson note
        function rejectLessonNote(id) {
            const note = sampleData.lessonNotes.find(n => n.id === id);
            if (note) {
                note.status = 'rejected';
                note.feedback = 'Please revise and resubmit. Feedback provided on ' + new Date().toLocaleDateString();
                updateAdminDashboard();
            }
        }

        // Approve assignment
        function approveAssignment(id) {
            const assignment = sampleData.assignments.find(a => a.id === id);
            if (assignment) {
                assignment.status = 'approved';
                assignment.feedback = 'Approved by admin on ' + new Date().toLocaleDateString();
                updateAdminDashboard();
            }
        }

        // Reject assignment
        function rejectAssignment(id) {
            const assignment = sampleData.assignments.find(a => a.id === id);
            if (assignment) {
                assignment.status = 'rejected';
                assignment.feedback = 'Please revise and resubmit. Feedback provided on ' + new Date().toLocaleDateString();
                updateAdminDashboard();
            }
        }

        // Add new student
        function addStudent() {
            const name = document.getElementById('student-name').value;
            const studentClass = document.getElementById('student-class').value;
            
            if (!name || !studentClass) {
                alert('Please enter student name and select a class');
                return;
            }
            
            // Generate student ID and credentials
            const newId = 'STU' + (sampleData.students.length + 1).toString().padStart(3, '0');
            const username = name.toLowerCase().replace(/\s+/g, '') + (sampleData.students.length + 1);
            const password = 'stud' + (sampleData.students.length + 1);
            
            // Add to sample data
            sampleData.students.push({
                id: newId,
                name: name,
                class: studentClass,
                username: username,
                password: password,
                addedBy: currentUser.name,
                status: 'active'
            });
            
            // Also add to users for login
            sampleData.users.push({
                username: username,
                password: password,
                role: 'student',
                name: name,
                class: studentClass,
                status: 'active'
            });
            
            // Update dashboard
            updateAdminDashboard();
            
            // Clear form
            document.getElementById('student-name').value = '';
            document.getElementById('student-class').value = '';
            
            alert(`Student added successfully!\nUsername: ${username}\nPassword: ${password}`);
        }

        // Register new teacher
        function registerTeacher() {
            const name = document.getElementById('teacher-name').value;
            const email = document.getElementById('teacher-email').value;
            const teacherClass = document.getElementById('teacher-class').value;
            const subject = document.getElementById('teacher-subject').value;
            
            if (!name) {
                alert('Please enter teacher name');
                return;
            }
            
            // Generate username and password
            const username = name.toLowerCase().replace(/\s+/g, '') + (sampleData.users.filter(u => u.role === 'teacher').length + 1);
            const password = 'pass' + (sampleData.users.filter(u => u.role === 'teacher').length + 1);
            
            // Add to sample data
            sampleData.users.push({
                username: username,
                password: password,
                role: 'teacher',
                name: name,
                email: email,
                class: teacherClass,
                subject: subject,
                status: 'active'
            });
            
            // Update dashboard
            updateAdminDashboard();
            
            // Clear form
            document.getElementById('teacher-name').value = '';
            document.getElementById('teacher-email').value = '';
            document.getElementById('teacher-class').value = '';
            document.getElementById('teacher-subject').value = '';
            
            // Update teacher select dropdown
            populateTeacherSelect();
            
            alert(`Teacher registered successfully!\nUsername: ${username}\nPassword: ${password}`);
        }

        // Toggle teacher status (active/inactive)
        function toggleTeacherStatus(username, status) {
            const teacher = sampleData.users.find(u => u.username === username && u.role === 'teacher');
            if (teacher) {
                teacher.status = status;
                updateAdminDashboard();
                populateTeacherSelect();
                alert(`Teacher status updated to ${status}`);
            }
        }

        // Delete teacher
        function deleteTeacher(username) {
            if (confirm('Are you sure you want to delete this teacher? This action cannot be undone.')) {
                const teacherIndex = sampleData.users.findIndex(u => u.username === username && u.role === 'teacher');
                if (teacherIndex !== -1) {
                    sampleData.users.splice(teacherIndex, 1);
                    updateAdminDashboard();
                    populateTeacherSelect();
                    alert('Teacher deleted successfully');
                }
            }
        }

        // Submit lesson note (teacher)
        function submitLessonNote() {
            const subject = document.getElementById('lesson-subject').value;
            const note = document.getElementById('lesson-note').value;
            
            if (!subject || !note) {
                alert('Please enter both subject and lesson note');
                return;
            }
            
            // Add to sample data
            sampleData.lessonNotes.push({
                id: sampleData.lessonNotes.length + 1,
                teacher: currentUser.name,
                date: new Date().toISOString().split('T')[0],
                subject: subject,
                note: note,
                status: 'pending',
                feedback: ''
            });
            
            // Update dashboard
            updateTeacherDashboard();
            
            // Clear form
            document.getElementById('lesson-subject').value = '';
            document.getElementById('lesson-note').value = '';
            
            alert('Lesson note submitted successfully!');
        }

        // Submit assignment (teacher)
        function submitAssignment() {
            const assignmentClass = document.getElementById('assignment-class').value;
            const subject = document.getElementById('assignment-subject').value;
            const details = document.getElementById('assignment-details').value;
            const dueDate = document.getElementById('due-date').value;
            
            if (!assignmentClass || !subject || !details || !dueDate) {
                alert('Please fill in all fields');
                return;
            }
            
            // Add to sample data
            sampleData.assignments.push({
                id: sampleData.assignments.length + 1,
                teacher: currentUser.name,
                class: assignmentClass,
                subject: subject,
                assignment: details,
                dueDate: dueDate,
                status: 'pending',
                feedback: ''
            });
            
            // Update dashboard
            updateTeacherDashboard();
            
            // Clear form
            document.getElementById('assignment-class').value = '';
            document.getElementById('assignment-subject').value = '';
            document.getElementById('assignment-details').value = '';
            document.getElementById('due-date').value = '';
            
            alert('Assignment submitted successfully!');
        }

        // Utility function to show messages
        function showMessage(element, text, type) {
            element.textContent = text;
            element.className = `message ${type}`;
            element.style.display = 'block';
            
            // Hide message after 3 seconds
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>